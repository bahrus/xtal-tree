(function(){var a=function(a){function b(){return babelHelpers.classCallCheck(this,b),babelHelpers.possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return babelHelpers.inherits(b,a),babelHelpers.createClass(b,[{key:'selectNodeShallow',value:function(a){this._isSelectedFn(a)||this._toggleNodeSelectionFn(a),this._isIndeterminateFn(a)&&this._toggleInterminateFn(a)}},{key:'unselectNodeShallow',value:function(a){this._isSelectedFn(a)&&this._toggleNodeSelectionFn(a),this._isIndeterminateFn(a)&&this._toggleInterminateFn(a)}},{key:'setNodeIndeterminate',value:function(a){this._isIndeterminateFn(a)||this._toggleInterminateFn(a)}},{key:'selectNodeAndCascade',value:function(a){this.selectNodeRecursive(a);var b=a;do{var c=this._keyFn(b),d=this._childToParentLookup[c];if(d){var e=this._keyFn(d);this._selectedChildScore[e]++;var f=this._childrenFn(d);this._selectedChildScore[e]===f.length?this.selectNodeShallow(d):this.setNodeIndeterminate(d)}b=d}while(b)}},{key:'unselectNodeAndCascade',value:function(a){this.unselectNodeRecursive(a);var b=a;do{var c=this._keyFn(b),d=this._childToParentLookup[c];if(d){var e=this._keyFn(d);this._selectedChildScore[e]--,0===this._selectedChildScore[e]?this.unselectNodeShallow(d):(!this._isIndeterminateFn(d)&&this._toggleInterminateFn(d),this._isSelectedFn(d)&&this._toggleNodeSelectionFn(d))}b=d}while(b)}},{key:'selectNodeRecursive',value:function(a){var b=this;this.selectNodeShallow(a);var c=this._childrenFn(a);c&&(this._selectedChildScore[this._keyFn(a)]=c.length,c.forEach(function(a){return b.selectNodeRecursive(a)}))}},{key:'unselectNodeRecursive',value:function(a){var b=this;this.unselectNodeShallow(a);var c=this._childrenFn(a);c&&(this._selectedChildScore[this._keyFn(a)]=0,c.forEach(function(a){return b.unselectNodeRecursive(a)}))}},{key:'onPropsChange',value:function(){this._keyFn&&this._childrenFn&&this._nodes&&this._isSelectedFn&&this._toggleNodeSelectionFn&&this._toggleInterminateFn&&this.startCreatingChildToParentLookup()}},{key:'startCreatingChildToParentLookup',value:function(){this._childToParentLookup={},this._selectedChildScore={},this.createChildToParentLookup(this._nodes,this._childToParentLookup)}},{key:'createChildToParentLookup',value:function(a,b){var c=this;a.forEach(function(a){var d=c._keyFn(a),e=c._selectedChildScore;e[d]=0;var f=c._childrenFn(a);f&&(f.forEach(function(f){c._isSelectedFn(f)&&e[d]++;var g=c._keyFn(f);b[g]=a}),e[d]===f.length?c.selectNodeShallow(a):0<e[d]&&c._toggleInterminateFn(a),c.createChildToParentLookup(f,b))}),this.updateSelectedRootNodes()}},{key:'updateSelectedRootNodes',value:function(){this._selectedRootNodes=this._calculateSelectedRootNodes(this._nodes,[]),this.notifySelectedRootNodesChanged()}},{key:'notifySelectedRootNodesChanged',value:function(){var a=new CustomEvent('selected-root-nodes-changed',{detail:{value:this._selectedRootNodes},bubbles:!0,composed:!0});this.dispatchEvent(a)}},{key:'_calculateSelectedRootNodes',value:function(a,b){var c=this;return a.forEach(function(a){if(c._isSelectedFn(a))b.push(a);else if(c._isIndeterminateFn(a)){var d=c._childrenFn(a);d&&c._calculateSelectedRootNodes(d,b)}}),b}},{key:'childrenFn',get:function(){return this._childrenFn},set:function(a){this._childrenFn=a,this.onPropsChange()}},{key:'keyFn',get:function(){return this._keyFn},set:function(a){this._keyFn=a,this.onPropsChange()}},{key:'isSelectedFn',get:function(){return this._isSelectedFn},set:function(a){this._isSelectedFn=a}},{key:'isIndeterminateFn',get:function(){return this._isIndeterminateFn},set:function(a){this._isIndeterminateFn=a}},{key:'toggleNodeSelectionFn',get:function(){return this._toggleNodeSelectionFn},set:function(a){this._toggleNodeSelectionFn=a}},{key:'toggleIndeterminateFn',get:function(){return this._toggleInterminateFn},set:function(a){this._toggleInterminateFn=a}},{key:'toggledNodeSelection',set:function(a){this._isSelectedFn(a)?this.unselectNodeAndCascade(a):this.selectNodeAndCascade(a),this.updateSelectedRootNodes()}},{key:'nodes',get:function(){return this._nodes},set:function(a){this._nodes=a,this.onPropsChange()}},{key:'selectedRootNodes',get:function(){return this._selectedRootNodes},set:function(a){this._selectedRootNodes=a}}]),b}(HTMLElement);customElements.define('xtal-cascade',a)})();