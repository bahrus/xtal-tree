<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<body>
    <div>
        <style>
            #directory details>section{
                margin-left:20px;
                display:flex;
                flex-direction:column;
            }

            #directory .match{
                font-weight: 800;
            }

            
        </style>
        <xtal-sip><script nomodule>["xtal-fetch-req", "p-d-r"]</script></xtal-sip>
        <button>Expand All</button>
        <p-d-r on="click" to="details" prop="allExpanded" val="target" skip-init></p-d-r>
        <button>Collapse All</button>
        <p-d-r on="click" to="details" prop="allCollapsed" val="target" skip-init></p-d-r>
        <label for="search">Search</label>
        <input autocomplete="off" id="search">
        <p-d-r on="input" to="details" prop="searchString" val="target.value" skip-init></p-d-r>
        <xtal-fetch-req p-d-if="p-d-r" id="directory" fetch href="directory.html" as="text" insert-results></xtal-fetch-req>
        <script defer src="https://cdn.jsdelivr.net/npm/es-module-shims@0.2.7/dist/es-module-shims.js"></script>
        <script type="importmap-shim">
        {
            "imports": {
                "xtal-element/": "../node_modules/xtal-element/",
                "trans-render/": "../node_modules/trans-render/",
                "xtal-sip": "https://cdn.jsdelivr.net/npm/xtal-sip@0.0.87/xtal-sip.js",
                "xtal-fetch-req": "https://cdn.jsdelivr.net/npm/xtal-fetch@0.0.58/xtal-fetch-req.js",
                "p-d": "https://cdn.jsdelivr.net/npm/p-et-alia@0.0.3/p-d.js",
                "p-d-r": "https://cdn.jsdelivr.net/npm/p-et-alia@0.0.3/p-d-r.js",
                "xtal-deco": "https://cdn.jsdelivr.net/npm/xtal-decorator@0.0.46/xtal-deco.js"
            }
        }
        </script>
        <script type="module-shim">
            import 'xtal-sip';
            import {XtalTreeDeco} from '../xtal-tree2.js';
            directory.addEventListener('fetch-complete', e =>{
                console.log('start');
                XtalTreeDeco(directory.querySelector('details'), true);
                console.log('end');
            })
        </script>
        <!-- <script>
            function expandAll(){
                document.querySelectorAll('details').forEach(detail => detail.setAttribute('open', ''));
            }
        </script> -->
    </div>
</body>
</html>