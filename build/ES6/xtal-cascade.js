(function(){class a extends HTMLElement{get childrenFn(){return this._childrenFn}set childrenFn(a){this._childrenFn=a,this.onPropsChange()}get keyFn(){return this._keyFn}set keyFn(a){this._keyFn=a,this.onPropsChange()}get isSelectedFn(){return this._isSelectedFn}set isSelectedFn(a){this._isSelectedFn=a}get isIndeterminateFn(){return this._isIndeterminateFn}set isIndeterminateFn(a){this._isIndeterminateFn=a}get toggleNodeSelectionFn(){return this._toggleNodeSelectionFn}set toggleNodeSelectionFn(a){this._toggleNodeSelectionFn=a}get toggleIndeterminateFn(){return this._toggleInterminateFn}set toggleIndeterminateFn(a){this._toggleInterminateFn=a}set toggledNodeSelection(a){this._isSelectedFn(a)?this.unselectNodeAndCascade(a):this.selectNodeAndCascade(a),this.updateSelectedRootNodes()}selectNodeShallow(a){this._isSelectedFn(a)||this._toggleNodeSelectionFn(a),this._isIndeterminateFn(a)&&this._toggleInterminateFn(a)}unselectNodeShallow(a){this._isSelectedFn(a)&&this._toggleNodeSelectionFn(a),this._isIndeterminateFn(a)&&this._toggleInterminateFn(a)}setNodeIndeterminate(a){this._isIndeterminateFn(a)||this._toggleInterminateFn(a)}selectNodeAndCascade(a){this.selectNodeRecursive(a);let b=a;do{const a=this._keyFn(b),c=this._childToParentLookup[a];if(c){const a=this._keyFn(c);this._selectedChildScore[a]++;const b=this._childrenFn(c);this._selectedChildScore[a]===b.length?this.selectNodeShallow(c):this.setNodeIndeterminate(c)}b=c}while(b)}unselectNodeAndCascade(a){this.unselectNodeRecursive(a);let b=a;do{const a=this._keyFn(b),c=this._childToParentLookup[a];if(c){const a=this._keyFn(c);this._selectedChildScore[a]--,0===this._selectedChildScore[a]?this.unselectNodeShallow(c):(!this._isIndeterminateFn(c)&&this._toggleInterminateFn(c),this._isSelectedFn(c)&&this._toggleNodeSelectionFn(c))}b=c}while(b)}selectNodeRecursive(a){this.selectNodeShallow(a);const b=this._childrenFn(a);b&&(this._selectedChildScore[this._keyFn(a)]=b.length,b.forEach((a)=>this.selectNodeRecursive(a)))}unselectNodeRecursive(a){this.unselectNodeShallow(a);const b=this._childrenFn(a);b&&(this._selectedChildScore[this._keyFn(a)]=0,b.forEach((a)=>this.unselectNodeRecursive(a)))}get nodes(){return this._nodes}set nodes(a){this._nodes=a,this.onPropsChange()}onPropsChange(){this._keyFn&&this._childrenFn&&this._nodes&&this._isSelectedFn&&this._toggleNodeSelectionFn&&this._toggleInterminateFn&&this.startCreatingChildToParentLookup()}startCreatingChildToParentLookup(){this._childToParentLookup={},this._selectedChildScore={},this.createChildToParentLookup(this._nodes,this._childToParentLookup)}createChildToParentLookup(a,b){a.forEach((a)=>{const c=this._keyFn(a),d=this._selectedChildScore;d[c]=0;const e=this._childrenFn(a);e&&(e.forEach((e)=>{this._isSelectedFn(e)&&d[c]++;const f=this._keyFn(e);b[f]=a}),d[c]===e.length?this.selectNodeShallow(a):0<d[c]&&this._toggleInterminateFn(a),this.createChildToParentLookup(e,b))}),this.updateSelectedRootNodes()}updateSelectedRootNodes(){this._selectedRootNodes=this._calculateSelectedRootNodes(this._nodes,[]),this.notifySelectedRootNodesChanged()}notifySelectedRootNodesChanged(){const a=new CustomEvent('selected-root-nodes-changed',{detail:{value:this._selectedRootNodes},bubbles:!0,composed:!0});this.dispatchEvent(a)}_calculateSelectedRootNodes(a,b){return a.forEach((a)=>{if(this._isSelectedFn(a))b.push(a);else if(this._isIndeterminateFn(a)){const c=this._childrenFn(a);c&&this._calculateSelectedRootNodes(c,b)}}),b}get selectedRootNodes(){return this._selectedRootNodes}set selectedRootNodes(a){this._selectedRootNodes=a}}customElements.define('xtal-cascade',a)})();