<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, minimum-scale=1, initial-scale=1, user-scalable=yes">

    <title>xtal-tree demo</title>

    <script src="../../webcomponentsjs/webcomponents-loader.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/xtal-fetch@0.0.20/build/ES6/xtal-fetch.js"></script>
    <script async src="https://cdn.jsdelivr.net/npm/xtal-decorator@0.0.12/build/ES6/xtal-decorator.js"></script>
    <script src="../xtal-tree.js"></script>
    <link rel="import" href="../../iron-demo-helpers/demo-pages-shared-styles.html">
    <link rel="import" href="../../iron-demo-helpers/demo-snippet.html">
    <link rel="import" href="../../polymer/lib/elements/dom-bind.html">
    <link rel="import" href="../../polymer/lib/elements/dom-repeat.html">
    <custom-style>
      <style is="custom-style" include="demo-pages-shared-styles">
      </style>
    </custom-style>
  </head>
  <body>
    <div class="vertical-section-container centered">
      <h3>Basic xtal-tree demo</h3>
      <demo-snippet>
        <template>
        <xtal-decorator>
          <script type="text/ecmascript ish">
            [{
              polymerProperties:{
                isOpenFn:{
                    type: Function,
                    value: function(node){
                      return node.expanded;
                    }
                },
                keyFn:{
                  type: Function,
                  value: function(node){
                    return node.path;
                  }
                },
                childrenFn:{
                  type: Function,
                  value: function(node){
                    return node.children;
                  }
                },
                toggleNodeFn:{
                  type: Function,
                  value: function(node){
                    node.expanded = !node.expanded;
                  }
                },
                
              },
              toggleNode(e){
                this.$.myTree.toggledNode = e.srcElement.node;
              }
            }]
          </script>
        </xtal-decorator>
        <dom-bind>
          <template>
              <xtal-fetch fetch href="directory.json" as="json" result="{{directory}}"></xtal-fetch>
              <xtal-tree id="myTree"
                is-open-fn="[[isOpenFn]]" 
                key-fn="[[keyFn]]" 
                children-fn = "[[childrenFn]]" 
                nodes="[[directory]]"
                toggle-node-fn="[[toggleNodeFn]]"
                viewable-nodes="{{viewableNodes}}"
                >
              </xtal-tree>
              <div>Click on Nodes below to toggle open / closed.</div><br>
              <template is="dom-repeat" items="[[viewableNodes]]">
                <div node="[[item]]" on-click="toggleNode">[[item.name]]</div>
              </template>
          </template>
        </dom-bind>

        </template>
      </demo-snippet>
    </div>
  </body>
</html>
